# ProteinMTP 项目进度与讨论文档

> 📅 **创建日期**：2026-01-24 
> 👤 **作者**：黄海军  
> 🔗 **GitHub 仓库**：git@github.com:buzhimingLF/ProteinMTP---Multi-Token-Prediction-for-Protein-Sequence-Generation.git

---

## 📌 项目简介

**项目名称**：ProteinMTP - 基于多标记预测的蛋白质序列生成研究

**核心目标**：将 Multi-Token Prediction (MTP) 技术应用于蛋白质序列预测任务，探索 MTP 在生物序列生成领域的潜力。

---

## 🚀 当前进度

### ✅ 已完成
- [x] 确定研究方向：Multi-Token Prediction for Protein Sequences
- [x] 获取参考论文：[arxiv:2504.03159](https://arxiv.org/abs/2504.03159)
- [x] 确定数据集：[PDBbind-Plus](https://www.pdbbind-plus.org.cn/)
- [x] 获取师兄的参考代码（基于 Qwen 的 MTP 实现）

### 🔄 进行中
- [ ] 阅读理解参考论文
- [ ] 探索 PDBbind-Plus 数据集结构
- [ ] 分析师兄代码的核心逻辑

### ⏳ 待开始
- [ ] 代码改造（VL → 纯文本）
- [ ] 数据预处理流程设计
- [ ] 实验设计与执行

---

## ❓ 待讨论问题

### 🔴 高优先级

#### 1. 数据集选择与处理
**问题**：PDBbind-Plus 数据集主要是蛋白质-配体结合数据，如何从中提取适合 MTP 训练的蛋白质序列数据？

**我的想法**：
- 方案A：直接使用蛋白质序列作为训练数据
- 方案B：结合配体信息，做条件生成任务

**需要师兄确认**：
- 数据集的具体使用方式？
- 是否有推荐的数据预处理流程？

---

#### 2. 任务定义
**问题**：具体的预测任务是什么？

**可能的任务类型**：
| 任务类型 | 描述 | 难度 |
|---------|------|------|
| 序列补全 | 给定部分序列，预测剩余部分 | ⭐⭐ |
| 序列生成 | 从头生成完整蛋白质序列 | ⭐⭐⭐ |
| 条件生成 | 根据功能描述生成序列 | ⭐⭐⭐⭐ |
| 序列优化 | 优化现有序列的某些属性 | ⭐⭐⭐ |

**需要师兄确认**：推荐哪种任务类型？

---

#### 3. 模型选择
**问题**：最小模型具体选择哪个？

**候选模型**：
- Qwen-0.5B（最小，适合快速验证）
- Qwen-1.8B（平衡性能和资源）
- ESM-2（专门针对蛋白质的预训练模型）

**硬件限制**：RTX 3090 (24GB)

**需要师兄建议**：
- 是否继续使用 Qwen 系列？
- 还是考虑使用蛋白质专用模型如 ESM？

---

### 🟡 中优先级

#### 4. MTP 预测头数量
**问题**：Multi-Token Prediction 中，一次预测多少个 token 比较合适？

**参考**：
- 论文中的设置是？
- 蛋白质序列的特点（20种氨基酸）是否需要特殊考虑？

---

#### 5. 评估指标
**问题**：如何评估 MTP 在蛋白质序列上的效果？

**可能的指标**：
- Perplexity
- 序列准确率
- BLEU Score
- 生物学有效性（需要额外验证）

---

### 🟢 低优先级

#### 6. 代码改造细节
**问题**：师兄代码中的一些实现细节

**观察到的问题**：
- `HuggingfaceModelWithMTP` 类中使用了 `LabelWiseAttention`，这个在纯文本任务中如何调整？
- `num_of_pl_tokens` 参数的作用和设置？

---

## 💡 我的想法与思考

### 关于 MTP 的理解
Multi-Token Prediction 的核心思想是一次预测多个 token，而不是传统自回归的一次一个。这在蛋白质序列上可能有以下优势：

1. **效率提升**：蛋白质序列通常很长（几百到几千个氨基酸），MTP 可以显著加速生成
2. **全局依赖**：蛋白质的功能依赖于整体结构，MTP 可能更好地捕捉长程依赖
3. **并行化**：更适合 GPU 并行计算

### 潜在挑战
1. **序列特殊性**：蛋白质序列只有20种氨基酸，词表很小，是否需要特殊处理？
2. **生物学约束**：生成的序列需要满足一定的生物学规则
3. **评估困难**：如何验证生成序列的生物学有效性？

---

## 📊 实验计划

### Phase 1: 可行性验证（Week 1-2）
```
目标：用最小配置跑通整个流程
- 模型：Qwen-0.5B 或更小
- 数据：PDBbind-Plus 子集（1000条）
- 任务：简单的序列补全
```

### Phase 2: 基线实验（Week 3-4）
```
目标：建立基线，对比 MTP vs 传统自回归
- 实现标准自回归作为 baseline
- 实现 MTP 版本
- 对比两者的性能和效率
```

### Phase 3: 优化与扩展（Week 5-8）
```
目标：优化模型，扩大实验规模
- 调整 MTP 参数（预测头数量等）
- 扩大数据集规模
- 尝试更大的模型
```

---

## 📝 会议记录

### 2026-01-24 初次讨论
**参与者**：我、师兄

**讨论内容**：
- 确定研究方向为 MTP
- 师兄提供了参考资料和代码
- 建议先用小模型跑通

**Action Items**：
- [ ] 我：阅读论文，理解 MTP 核心思想
- [ ] 我：探索数据集，了解数据格式
- [ ] 我：分析师兄代码，理解实现细节

---

## 🔗 参考资源

### 论文
- [Multi-Token Prediction](https://arxiv.org/abs/2504.03159) - 核心参考论文

### 数据集
- [PDBbind-Plus](https://www.pdbbind-plus.org.cn/) - 蛋白质-配体结合数据库

### 代码
- 师兄的 MTP 实现（本地）
- [Hugging Face Transformers](https://github.com/huggingface/transformers)
- [PEFT](https://github.com/huggingface/peft) - LoRA 微调

### 相关工作
- ESM (Evolutionary Scale Modeling) - Meta 的蛋白质语言模型
- ProtTrans - 蛋白质 Transformer 模型
- AlphaFold - 蛋白质结构预测

---

## 📬 联系方式

如有问题或建议，请通过以下方式联系：
- GitHub Issues
- 微信/邮件（私下沟通）

---

*最后更新：2026-01-24*
