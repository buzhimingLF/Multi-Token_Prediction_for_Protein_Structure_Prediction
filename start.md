# 毕业论文项目需求文档

## 📋 项目概述

**项目名称**：
- 中文名：基于多标记预测的蛋白质序列生成研究
- 英文名：ProteinMTP - Multi-Token Prediction for Protein Sequence Generation

**研究方向**：将 Multi-Token Prediction (MTP) 技术应用于蛋白质序列预测任务

---

## 🎯 研究背景与动机

### 原始想法
最初计划做自回归优化，匹配蛋白质序列的k值，一次预测一个蛋白质。

### 师兄建议
经过讨论，师兄建议直接往 **Multi-Token Prediction** 方向做：
- 两边的工程量其实差不多
- MTP 在蛋白质序列预测上有更好的研究价值和创新点

---

## 📚 核心参考资料

### 参考论文
- **论文链接**：https://arxiv.org/abs/2504.03159
- **论文主题**：Multi-Token Prediction 相关研究
- **需要重点关注**：
  - [ ] MTP 的核心思想和实现方法
  - [ ] 与传统自回归方法的对比
  - [ ] 在序列生成任务上的应用

### 数据集
- **数据集名称**：PDBbind-Plus
- **数据集链接**：https://www.pdbbind-plus.org.cn/
- **数据集特点**：
  - 蛋白质-配体结合数据
  - 包含蛋白质序列信息
  - 需要进一步了解数据格式和预处理方式

### 参考代码
- **来源**：师兄提供的基于 Qwen 实现的 MTP 代码
- **原始用途**：带视频的 VL（Vision-Language）模型
- **改造方向**：改成纯文本模型，适配蛋白质序列任务

---

## 🛠️ 技术栈与环境

### 硬件环境
| 配置项 | 规格 |
|--------|------|
| GPU | NVIDIA RTX 3090 |
| 显存 | 24GB |

### 软件依赖
- PyTorch
- Transformers (Hugging Face)
- PEFT (LoRA 微调)
- DeepSpeed (可选，用于分布式训练)

### 基础模型选择
- **优先使用最小模型跑通**，再逐步加大模型和数据量
- 候选模型：
  - Qwen 系列小模型
  - 其他适合蛋白质序列的预训练模型

---

## 📝 待完成任务清单

### 第一阶段：环境准备与代码理解
- [ ] 阅读并理解参考论文 (arxiv:2504.03159)
- [ ] 下载并探索 PDBbind-Plus 数据集
- [ ] 理解师兄的 MTP 代码实现

### 第二阶段：代码改造
- [ ] 将 VL 模型改为纯文本模型
- [ ] 修改数据处理流程，适配蛋白质序列
- [ ] 调整 metric 计算方法

### 第三阶段：实验与验证
- [ ] 使用最小模型跑通整个流程
- [ ] 验证 MTP 在蛋白质序列上的效果
- [ ] 逐步扩大模型规模和数据量

### 第四阶段：论文撰写
- [ ] 整理实验结果
- [ ] 撰写毕业论文

---

## 🔧 代码改造要点

根据师兄提供的代码（`SFT_main.py` 和 `SFT_infer.py`），需要进行以下改造：

### 1. 模型改造
```python
# 原始：使用 AutoModelForImageTextToText（支持图像和视频）
base_model = AutoModelForImageTextToText.from_pretrained(...)

# 改造：使用纯文本模型
base_model = AutoModelForCausalLM.from_pretrained(...)
```

### 2. 数据处理改造
- 移除图像/视频相关的处理逻辑
- 设计蛋白质序列的输入格式
- 定义适合蛋白质任务的标签体系

### 3. Metric 计算改造
- 根据蛋白质序列预测任务的特点设计评估指标
- 可能需要的指标：序列准确率、BLEU、perplexity 等

---

## ❓ 待确认问题

1. **数据集相关**
   - PDBbind-Plus 数据集的具体格式是什么？
   - 如何从数据集中提取蛋白质序列？
   - 训练集/验证集/测试集如何划分？

2. **模型相关**
   - 最小模型具体选择哪个？（如 Qwen-0.5B？）
   - MTP 的预测头数量如何设置？

3. **任务定义**
   - 具体的预测任务是什么？（序列生成？结构预测？）
   - 输入输出的格式如何定义？

---

## 📅 时间规划

| 阶段 | 时间 | 任务 |
|------|------|------|
| Week 1-2 | 论文阅读 | 深入理解 MTP 论文和相关工作 |
| Week 3-4 | 数据准备 | 下载、探索、预处理数据集 |
| Week 5-6 | 代码改造 | 完成代码从 VL 到纯文本的改造 |
| Week 7-8 | 初步实验 | 小模型跑通，验证可行性 |
| Week 9-12 | 正式实验 | 扩大规模，完善实验 |
| Week 13-16 | 论文撰写 | 整理结果，撰写论文 |

---

## 📞 沟通记录

### 2026-01-24 与师兄讨论
- **我的想法**：做自回归优化，匹配蛋白质序列的k值
- **师兄建议**：直接往 Multi-Token Prediction 上做
- **理由**：两边工程量差不多，MTP 更有研究价值
- **提供资源**：论文链接、数据集链接、参考代码

---

## 📖 论文阅读笔记

### 参考论文：Beyond the Next Token (arxiv:2504.03159)

**论文标题**：Beyond the Next Token: Towards Prompt-Robust Zero-Shot Classification via Efficient Multi-Token Prediction

**核心方法**：Placeholding Parallel Prediction (P3)
- 一种新的多标记预测方法
- 用于零样本文本分类任务
- 通过预测多个位置的token概率来提高鲁棒性

**关键发现**：
- 传统方法过于依赖下一个token的概率，导致对prompt敏感
- P3方法可以减少98%的标准差，提高鲁棒性
- 即使没有prompt，P3也能保持较好的性能

**对我们项目的启示**：
- MTP的核心思想：一次预测多个token，而不是逐个预测
- 可以借鉴P3的并行预测思想应用到蛋白质序列生成
- 需要设计适合蛋白质序列的placeholder机制

---

## 📊 数据集说明

### PDBbind-Plus 数据集选择建议

根据数据集网站信息，推荐使用以下数据：

**推荐方案：PDBbind v2020.R1（免费版本）**
- ✅ 免费开放给注册用户
- ✅ 质量经过重新处理，比原始v2020更高
- ✅ 包含19,037个蛋白质-配体复合物

**具体文件**：
| 文件 | 描述 | 大小 |
|------|------|------|
| Index files | 索引文件（PDB代码、分辨率、结合数据等） | 497KB |
| Protein-ligand complexes | 蛋白质-配体复合物结构 | 3.1GB |

**备选方案：PDBbind v2024（如需更多数据）**
- 包含更多复合物（约27,000+）
- 需要购买或申请

---

*文档最后更新：2026-01-24*
